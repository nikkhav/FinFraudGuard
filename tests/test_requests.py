import requests

URL = "http://localhost:8000/predict"

test_cases = [
    {
        "label": "Should be fraud",
        "expected": True,
        "payload": {
            "Time": 406, "V1": -2.3122, "V2": 1.9520, "V3": -1.6098, "V4": 3.9979, "V5": -0.5221,
            "V6": -1.4265, "V7": -2.5373, "V8": 1.3916, "V9": -2.7700, "V10": -2.7722, "V11": 3.2020,
            "V12": -2.8999, "V13": -0.5952, "V14": -4.2892, "V15": 0.3897, "V16": -1.1407, "V17": -2.8300,
            "V18": -0.0168, "V19": 0.4169, "V20": 0.1269, "V21": 0.5172, "V22": -0.0350, "V23": -0.4652,
            "V24": 0.3201, "V25": 0.0445, "V26": 0.1778, "V27": 0.2611, "V28": -0.1432, "Amount": 0
        }
    },
    {
        "label": "Should be fraud",
        "expected": True,
        "payload": {
            "Time": 472, "V1": -3.0435, "V2": -3.1573, "V3": 1.0884, "V4": 2.2886, "V5": 1.3598,
            "V6": -1.0648, "V7": 0.3255, "V8": -0.0677, "V9": -0.2709, "V10": -0.8385, "V11": -0.4145,
            "V12": -0.5031, "V13": 0.6765, "V14": -1.6920, "V15": 2.0006, "V16": 0.6667, "V17": 0.5997,
            "V18": 1.7253, "V19": 0.2833, "V20": 2.1023, "V21": 0.6616, "V22": 0.4354, "V23": 1.3759,
            "V24": -0.2938, "V25": 0.2797, "V26": -0.1453, "V27": -0.2527, "V28": 0.0357, "Amount": 529
        }
    },
    {
        "label": "Should be legit",
        "expected": False,
        "payload": {
            "Time": 0, "V1": -1.3598, "V2": -0.0727, "V3": 2.5363, "V4": 1.3781, "V5": -0.3383, "V6": 0.4623,
            "V7": 0.2395, "V8": 0.0986, "V9": 0.3637, "V10": 0.0907, "V11": -0.5515, "V12": -0.6178,
            "V13": -0.9913, "V14": -0.3111, "V15": 1.4681, "V16": -0.4704, "V17": 0.2079, "V18": 0.0257,
            "V19": 0.4039, "V20": 0.2514, "V21": -0.0183, "V22": 0.2778, "V23": -0.1104, "V24": 0.0669,
            "V25": 0.1285, "V26": -0.1891, "V27": 0.1335, "V28": -0.0210, "Amount": 149.62
        }
    },
    {
        "label": "Should be legit",
        "expected": False,
        "payload": {
            "Time": 0, "V1": 1.1918, "V2": 0.2661, "V3": 0.1664, "V4": 0.4481, "V5": 0.0600, "V6": -0.0823,
            "V7": -0.0788, "V8": 0.0851, "V9": -0.2554, "V10": -0.1669, "V11": 1.6127, "V12": 1.0652,
            "V13": 0.4890, "V14": -0.1437, "V15": 0.6355, "V16": 0.4639, "V17": -0.1148, "V18": -0.1833,
            "V19": -0.1457, "V20": -0.0690, "V21": -0.2257, "V22": -0.6386, "V23": 0.1012, "V24": -0.3398,
            "V25": 0.1671, "V26": 0.1258, "V27": -0.0089, "V28": 0.0147, "Amount": 2.69
        }
    },
    {
        "label": "Should be legit",
        "expected": False,
        "payload": {
            "Time": 1, "V1": -1.3583, "V2": -1.3401, "V3": 1.7732, "V4": 0.3797, "V5": -0.5031, "V6": 1.8004,
            "V7": 0.7914, "V8": 0.2476, "V9": -1.5146, "V10": 0.2076, "V11": 0.6245, "V12": 0.0660,
            "V13": 0.7172, "V14": -0.1659, "V15": 2.3458, "V16": -2.8900, "V17": 1.1099, "V18": -0.1213,
            "V19": -2.2618, "V20": 0.5249, "V21": 0.2479, "V22": 0.7716, "V23": 0.9094, "V24": -0.6892,
            "V25": -0.3276, "V26": -0.1390, "V27": -0.0553, "V28": -0.0597, "Amount": 378.66
        }
    },
    {
        "label": "Should be legit",
        "expected": False,
        "payload": {
            "Time": 2, "V1": -1.1582, "V2": 0.8777, "V3": 1.5487, "V4": 0.4030, "V5": -0.4071, "V6": 0.0959,
            "V7": 0.5929, "V8": -0.2705, "V9": 0.8177, "V10": 0.7530, "V11": -0.8228, "V12": 0.5381,
            "V13": 1.3458, "V14": -1.1196, "V15": 0.1751, "V16": -0.4514, "V17": -0.2370, "V18": -0.0381,
            "V19": 0.8034, "V20": 0.4085, "V21": -0.0094, "V22": 0.7982, "V23": -0.1374, "V24": 0.1412,
            "V25": -0.2060, "V26": 0.5022, "V27": 0.2194, "V28": 0.2151, "Amount": 69.99
        }
    }
]


passed = 0

for i, case in enumerate(test_cases, 1):
    try:
        response = requests.post(URL, json=case["payload"])
        result = response.json()
        fraud = result["fraud"]
        proba = result["probability"]
        ok = fraud == case["expected"]
        status = "✅ PASSED" if ok else "❌ FAILED"
        if ok:
            passed += 1
        print(f"Test case {i}: {case['label']}")
        print(f"→ Expected fraud = {case['expected']} | Got: {fraud}, Probability = {proba} → {status}")
        print("-" * 60)
    except Exception as e:
        print(f"Test case {i} ERROR:", e)

print(f"\nSummary: {passed}/{len(test_cases)} test cases ✅ PASSED")